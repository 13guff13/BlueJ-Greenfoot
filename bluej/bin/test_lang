#!/bin/sh
# Checks our bluej languages files for discepancies against
# the reference language
# usage: test_lang language
#        eg ./test_lang german

test_it ()
{
$BINDIR/extract_handles < $LIBDIR/$1 | sort > /tmp/orig$$
$BINDIR/extract_handles < $LIBDIR/$2 | sort > /tmp/other$$
diff -w /tmp/orig$$ /tmp/other$$
rm -f /tmp/orig$$ /tmp/other$$
 }

test_props ()
 {
$BINDIR/extract_handles_props < $LIBDIR/$1 | sort > /tmp/orig$$
$BINDIR/extract_handles_props < $LIBDIR/$2 | sort > /tmp/other$$
diff -w /tmp/orig$$ /tmp/other$$
rm -f /tmp/orig$$ /tmp/other$$
 }

BINDIR=`dirname $0`
. $BINDIR/config

BLUEJ_HOME=$BINDIR/.. 
REFERENCE_LANG=english
LIBDIR=$BLUEJ_HOME/lib

echo "# Testing dialogues"
test_it $REFERENCE_LANG/dialogues $1/dialogues
echo "# Testing exception.help"
test_it $REFERENCE_LANG/exception.help $1/exception.help
echo "# Testing jikes.help"
test_it $REFERENCE_LANG/jikes.help $1/jikes.help
echo "# Testing javac.help"
test_it $REFERENCE_LANG/javac.help $1/javac.help
echo "# Testing moe.help"
test_it $REFERENCE_LANG/moe.help $1/moe.help

echo "# Testing labels"
test_props $REFERENCE_LANG/labels $1/labels

